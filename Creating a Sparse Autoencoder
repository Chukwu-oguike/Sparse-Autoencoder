{"cells":[{"cell_type":"markdown","metadata":{"id":"NWthF3_ZSBuz"},"source":["In this project we implement a sparse autoencoder for image compression. In order to do this we implement the following steps\n","\n","\n","*   Implement forward propagation in your neural network, and implement the squared error term of the cost function.  Implement backpropagation to compute the derivatives.   Then (using lambda=beta=0), we run Gradient Checking to verify that the calculations corresponding to the squared error cost term are correct.\n","\n","*   Add in the weight decay term (in both the cost function and the derivative calculations), then re-run Gradient Checking to verify correctness.\n","\n","*   Add in the sparsity penalty term, then re-run Gradient Checking to verify correctness."]},{"cell_type":"code","source":["import math\n","import matplotlib.pyplot as plt\n","import matplotlib.cm as cm\n","import numpy as np\n","import random\n","import gc\n","import scipy.optimize\n","from scipy.io import loadmat\n","from google.colab import drive\n","drive.mount('/content/drive')"],"metadata":{"id":"MdAI7EvAZZ6X"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ot_M7XxvYHnK"},"outputs":[],"source":["\n","def sigmoid(Z):\n","    A = 1 / (1 + np.exp(-Z))\n","    return A\n","\n","\n","def sigmoid_gradient(Z):\n","    A = sigmoid(Z)\n","    dZ = A * (1 - A)\n","\n","    return dZ\n","\n","def sparse_autoencoder_cost(theta, visible_size, hidden_size, decay_lambda, sparsity_param, beta, data):\n","\n","    # get indices of each variable in theta\n","    vis_idx = visible_size * hidden_size\n","    hidden_idx = visible_size * hidden_size + vis_idx\n","    hidden_bias_idx = hidden_idx + hidden_size\n","    visible_bias_idx = hidden_bias_idx + visible_size\n","\n","    # get weights from flatten dataset\n","    visible_weights = theta[0:vis_idx]\n","    hidden_weights = theta[vis_idx:hidden_idx]\n","    hidden_bias = theta[hidden_idx:hidden_bias_idx]\n","    visible_bias = theta[hidden_bias_idx:visible_bias_idx]\n","    m = len(data)\n","\n","    # calculate weights for 1st and 2nd layer\n","    W1 = np.reshape(visible_weights, (hidden_size, visible_size))\n","    W2 = np.reshape(hidden_weights, (visible_size, hidden_size))\n","\n","\n","    z2 = np.dot(W1, data.transpose())\n","\n","    for i in range(0,z2.shape[1]):\n","        z2[:,i] = z2[:,i] + hidden_bias\n","\n","    a2 = sigmoid(z2)\n","    z3 = np.dot(W2, a2)\n","\n","    for i in range(0,z3.shape[1]):\n","        z3[:,i] = z3[:,i] + visible_bias\n","\n","    a3 = sigmoid(z3)\n","\n","\n","    # calculate average activation of hidden unit\n","    rho = np.empty_like(a2[:,1], dtype=float)\n","\n","    for i in range(0,len(rho)):\n","        rho[i] = np.sum(a2[i,:])*(1/m)\n","\n","    # Calculate cos\n","    KLp_pl = sparsity_param*np.log(sparsity_param/rho) + (1 - sparsity_param)*np.log((1 - sparsity_param)/(1 - rho))\n","\n","    reg_term = (np.linalg.norm(theta[0:hidden_idx]))**2\n","\n","    diff = a3 - data.transpose()\n","\n","    JWBxy = [0.5*np.square(np.linalg.norm(diff[:,i])) for i in range(0,diff.shape[1])]\n","\n","    cost = (1/m)*np.sum(JWBxy) + (decay_lambda/2)*reg_term + beta * np.sum(KLp_pl)\n","\n","    # caculate gradient\n","    d3 = -(data.transpose() - a3) * sigmoid_gradient(z3)\n","    temp2 = (sparsity_param/rho) + (1 - sparsity_param)/(1 - rho)\n","    d2 = np.dot(W2.transpose(), d3)\n","\n","    for i in range(0,d2.shape[1]):\n","        d2[:,i] = d2[:,i] + beta * temp2\n","\n","    d2 = d2 * sigmoid_gradient(z2)\n","\n","    # get average cost gradient per weight for W1\n","    grad_w2 = np.zeros(W2.shape, dtype=float)\n","    for i in range(d3.shape[1]):\n","        grad_w2 = grad_w2 + np.dot(d3[:,i].reshape(len(d3), 1), a2[:,i].reshape(1, len(a2)))\n","\n","    grad_w2 = (grad_w2 * 1/m) + (decay_lambda*W2)\n","\n","    # get average cost gradient per weight for W2\n","    grad_w1 = np.zeros(W1.shape, dtype=float)\n","    for i in range(d2.shape[1]):\n","        grad_w1 = grad_w1 + np.dot(d2[:,i].reshape(len(d2), 1), data[i,:].reshape(1,data.shape[1]))\n","\n","    grad_w1 = (grad_w1 * 1/m )+ (decay_lambda*W1)\n","\n","    # get average cost gradient per weight for B1 and B2\n","    grad_b2 = np.sum(d3, axis=1)/m\n","    grad_b1 = np.sum(d2, axis=1)/m\n","\n","    grad = np.concatenate((grad_w1.flatten(), grad_w2.flatten(), grad_b1.flatten(), grad_b2.flatten()))\n","\n","    return cost, grad"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"AYyvXW-kXqAn"},"outputs":[],"source":["cost, grad = sparse_autoencoder_cost(theta, visible_size, hidden_size, decay_lambda, sparsity_param, beta, patches)"]},{"cell_type":"code","source":[],"metadata":{"id":"UnfLWK48RDI4"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"qBwj0MA1BmFz"},"source":["**STEP 2:** We create a function that samples image pathces from a dataset and another function for displaying the image patch sampled`\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"2hglZn99AIBL"},"outputs":[],"source":["patch_size = 8\n","num_patches = 10000\n","visible_size = 8*8;     # number of input units\n","hidden_size = 25;       # number of hidden units\n","sparsity_param = 0.01;  # desired average activation of the hidden units.\n","                        # (This was denoted by the Greek alphabet rho, which\n","                        # looks like a lower-case \"p\", in the lecture notes).\n","decay_lambda = 0.0001;  # weight decay parameter (lambda)\n","beta = 3;               # weight of sparsity penalty term"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"48IeOvoobJOR"},"outputs":[],"source":["# This function visualizes filters in matrix A. Each row of A is a\n","# filter. We will reshape each row into a square image and visualizes\n","# on each cell of the visualization panel.\n","def display_network(data, cols=-1, opt_normalize=True, opt_graycolor=True, save_figure_path=None):\n","\n","    # rescale\n","    data -= np.mean(data)\n","\n","    # compute rows, cols\n","    num, area = data.shape\n","    sz = int(math.sqrt(area))\n","    buf = 1\n","    if cols < 0:\n","        if math.floor(math.sqrt(num)) ** 2 != num:\n","            n = math.ceil(math.sqrt(num))\n","            while num % n != 0 and n < 1.2 * math.sqrt(num):\n","                n += 1\n","                m = math.ceil(num / n)\n","        else:\n","            n = math.sqrt(num)\n","            m = n\n","    else:\n","        n = cols\n","        m = math.ceil(num / n)\n","    n = int(n)\n","    m = int(m)\n","\n","    array = -np.ones((buf + m * (sz + buf), buf + n * (sz + buf)))\n","\n","    if not opt_graycolor:\n","        array *= 0.1\n","\n","    k = 0\n","    for i in range(m):\n","        for j in range(n):\n","            if k >= num:\n","                continue\n","            if opt_normalize:\n","                clim = np.amax(np.absolute(data[k, :]))\n","            else:\n","                clim = np.amax(np.absolute(data))\n","            array[buf + i * (sz + buf):buf + i * (sz + buf) + sz,\n","            buf + j * (sz + buf):buf + j * (sz + buf) + sz] = data[k, :].reshape([sz, sz]) / clim\n","            k += 1\n","\n","    # simulate imagesc\n","    ax = plt.figure().gca()\n","    pix_width = 5\n","    h, w = array.shape\n","    exts = (0, pix_width * w, 0, pix_width * h)\n","    if opt_graycolor:\n","        ax.imshow(array, interpolation='nearest', extent=exts, cmap=cm.gray)\n","    else:\n","        ax.imshow(array, interpolation='nearest', extent=exts)\n","\n","    plt.axis('off')\n","\n","    if save_figure_path:\n","        plt.savefig(save_figure_path)\n","\n","    plt.show()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"FjpM5nAvUjp3"},"outputs":[],"source":["def initialize_parameters(hidden_size, visible_size):\n","    # Initialize parameters randomly based on layer sizes.\n","    r = math.sqrt(6) / math.sqrt(hidden_size + visible_size + 1)  # we'll choose weights uniformly from the interval [-r, r]\n","    w1 = np.random.rand(visible_size, hidden_size) * 2 * r - r\n","    w2 = np.random.rand(hidden_size, visible_size) * 2 * r - r\n","\n","    b1 = np.zeros((1, hidden_size))\n","    b2 = np.zeros((1, visible_size))\n","\n","    # Convert weights and bias gradients to the vector form.\n","    # This step will \"unroll\" (flatten and concatenate together) all\n","    # your parameters into a vector, which can then be used with minFunc.\n","    theta = np.concatenate((w1.flatten(), w2.flatten(), b1.flatten(), b2.flatten()))\n","\n","    return theta"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"w-yLpdTPIft1"},"outputs":[],"source":["# TODO:\n","def normalize_data(patches):\n","\n","    for i in range(0,len(patches)):\n","        temp = patches[i] - patches[i].mean()\n","        sigm3 = 3 * patches[i].std()\n","        temp1 = temp[(temp>=-sigm3) * (temp<=sigm3)]\n","        temp1 = temp1 / sigm3\n","        patches[i] = ((temp1+1) * 0.4) + 0.1\n","\n","    return patches\n","\n","def sample_images(patch_size, num_patches):\n","\n","    images = loadmat('/content/drive/My Drive/IMAGES.mat')['IMAGES']  # load images from disk\n","\n","    split_idx = images.shape[0] / patch_size\n","\n","    new_l = []\n","    for i in range(0,images.shape[2]):\n","\n","        l = np.array_split(images[:,:,i],split_idx,axis=0)\n","\n","        for iters in l:\n","            l = np.array_split(iters, split_idx, axis=1)\n","            l = [a.flatten() for a in l]\n","            new_l += l\n","\n","    new_l = np.array(new_l)\n","    idx = np.random.randint(len(images[0]), size=num_patches)\n","\n","    patches = new_l[idx,:]\n","\n","    return patches"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"5e-sIeVCIc_4","executionInfo":{"status":"ok","timestamp":1648948775615,"user_tz":240,"elapsed":1056,"user":{"displayName":"Chukwuemeka Oguike","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"01497694623157659581"}},"outputId":"ed81a864-a2c5-4e53-f3c3-73d3194f730d","colab":{"base_uri":"https://localhost:8080/","height":248}},"outputs":[{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 1 Axes>"],"image/png":"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\n"},"metadata":{"needs_background":"light"}}],"source":["patches = sample_images(patch_size, num_patches)\n","display_network(patches[np.random.randint(patches.shape[0], size=100), :])\n","\n","# Obtain random parameters theta\n","theta = initialize_parameters(hidden_size, visible_size)"]},{"cell_type":"markdown","metadata":{"id":"0memAWRGXwdJ"},"source":["**Step 3:** Gradient Checking\n","\n","We performing gradient checking on smaller models and smaller training sets to speed things up."]},{"cell_type":"code","execution_count":null,"metadata":{"id":"lXT2xQg7ULS9"},"outputs":[],"source":["# TODO:\n","# theta: a vector of parameters\n","# func: a function that outputs a real-number. Calling y = J(theta) will return the\n","# function value at theta.\n","def compute_numerical_gradient(func, theta, *args):\n","\n","    # Initialize numgrad (no need to initialize to zero, empty_like is a good fit here)\n","    numgrad = np.empty_like(theta, dtype=float) # YOU ARE SUPPOSED TO CHANGE STUFF IN THIS\n","\n","    EPSILON = 0.0001\n","    dim = len(numgrad)\n","\n","\n","    for i in range(0, dim):\n","\n","        e = np.eye(1, dim, k=i, dtype=float)\n","        t1 = theta + (EPSILON * e[0])\n","        t2 = theta - (EPSILON * e[0])\n","\n","        J1, grad1 = func(t1, *args)\n","        J2, grad2 = func(t2, *args)\n","\n","        numgrad[i] = (J1 - J2) / (2 * EPSILON)\n","\n","    return numgrad"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"GfsCip6e0slS"},"outputs":[],"source":["# this function accepts a 2D vector as input.\n","# Its outputs are:\n","# value: h(x1, x2) = x1^2 + 3*x1*x2\n","# grad: A 2x1 vector that gives the partial derivatives of h with respect to x1 and x2\n","# Note that when we pass @simpleQuadraticFunction(x) to computeNumericalGradients, I'm assuming\n","# that computeNumericalGradients will use only the first returned value of this function.\n","def simple_quadratic_function(x):\n","    value = pow(x[0], 2) + 3*x[0]*x[1]\n","    grad = np.zeros(2)\n","    grad[0]  = 2*x[0] + 3*x[1]\n","    grad[1]  = 3*x[0]\n","    return value, grad"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"hkPGPRLoyZft"},"outputs":[],"source":["# This function analytically evaluates the gradient of a very simple function called\n","# simpleQuadraticFunction and compares the result with your numerical\n","# solution.\n","def check_numerical_gradient():\n","    x = [4, 10]\n","    value, grad = simple_quadratic_function(x)\n","\n","    # I numerically compute the gradient of simpleQuadraticFunction at x.\n","    # (The notation \"@simpleQuadraticFunction\" denotes a pointer to a function.)\n","    numgrad = compute_numerical_gradient(simple_quadratic_function, x);\n","\n","    # Visually examine the two gradient computations.  The two columns\n","    disp = \"\\n\".join(\"{} {}\".format(x, y) for x, y in zip(numgrad, grad))\n","    print(disp)\n","    print(\"The above two columns you get should be very similar.\\n(Left-Your Numerical Gradient, Right-Analytical Gradient)\\n\\n\");\n","\n","    # Evaluation of the norm of the difference between two solutions.\n","    diff = np.linalg.norm(numgrad-grad)/np.linalg.norm(numgrad+grad);\n","    print(diff);\n","    print(\"Norm of the difference between numerical and analytical gradient (should be < 1e-9)\\n\\n\");"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"So3WH5vhyeog","executionInfo":{"status":"ok","timestamp":1648948789001,"user_tz":240,"elapsed":162,"user":{"displayName":"Chukwuemeka Oguike","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"01497694623157659581"}},"outputId":"bc2d02f9-3bf8-40bb-df52-d72848bdcba7","colab":{"base_uri":"https://localhost:8080/"}},"outputs":[{"output_type":"stream","name":"stdout","text":["37.99999999998249 38.0\n","11.999999999829924 12.0\n","The above two columns you get should be very similar.\n","(Left-Your Numerical Gradient, Right-Analytical Gradient)\n","\n","\n","2.1452381569477388e-12\n","Norm of the difference between numerical and analytical gradient (should be < 1e-9)\n","\n","\n"]}],"source":["# First, we make sure the numerical gradient computation is correct\n","check_numerical_gradient()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"cF-rv9RLyuMA"},"outputs":[],"source":["# Now I check the cost function and derivative calculations\n","# for the sparse autoencoder.\n","numgrad = compute_numerical_gradient(sparse_autoencoder_cost, theta, visible_size, hidden_size, decay_lambda, sparsity_param, beta, patches)\n","\n","# We visually compare the gradients side by side\n","disp = \"\\n\".join(\"{} {}\".format(x, y) for x, y in zip(numgrad, grad))\n","print(disp)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"AweZOO7Cy8Yi","executionInfo":{"status":"ok","timestamp":1648951977430,"user_tz":240,"elapsed":157,"user":{"displayName":"Chukwuemeka Oguike","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"01497694623157659581"}},"outputId":"0fec1552-a766-44dd-94ed-b3dd1fa0e017","colab":{"base_uri":"https://localhost:8080/"}},"outputs":[{"output_type":"stream","name":"stdout","text":["0.009427313607568504\n"]}],"source":["# Compare numerically computed gradients with the ones obtained from backpropagation\n","diff = np.linalg.norm(numgrad - grad)/np.linalg.norm(numgrad + grad);\n","print(diff);"]},{"cell_type":"markdown","metadata":{"id":"4iUF39lCzHTf"},"source":["**Step 4:** We start training the sparse autoencoder with scipy's minimize function."]},{"cell_type":"code","execution_count":null,"metadata":{"id":"4wmc2s6HzOP9"},"outputs":[],"source":["# Randomly initialize the parameters\n","theta = initialize_parameters(hidden_size, visible_size);\n","\n","# Here, we use L-BFGS to optimize our cost\n","# function.\n","\n","# Use scipy's minimize to minimize the function\n","res = scipy.optimize.minimize(\n","    fun=sparse_autoencoder_cost,\n","    x0=theta,\n","    args=(visible_size, hidden_size, decay_lambda, sparsity_param, beta, patches),\n","    method=\"L-BFGS-B\",\n","    jac=True,\n","    options={\"maxiter\":400,\"disp\":True});"]},{"cell_type":"markdown","metadata":{"id":"U4Vwok9QzcYy"},"source":["**STEP 5:** Visualization"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Qqy5uH8yzgQg","executionInfo":{"status":"ok","timestamp":1648867703951,"user_tz":240,"elapsed":259,"user":{"displayName":"Chukwuemeka Oguike","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"01497694623157659581"}},"outputId":"43803f45-27f7-4082-9f4c-69407cbbf46c","colab":{"base_uri":"https://localhost:8080/","height":248}},"outputs":[{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 1 Axes>"],"image/png":"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\n"},"metadata":{"needs_background":"light"}}],"source":["W1 = res.x[0:hidden_size * visible_size].reshape(visible_size, hidden_size)\n","display_network(W1.T, 5);"]}],"metadata":{"colab":{"provenance":[{"file_id":"15MmYIgNRFw_7Mymbj9HcDLi2jEjKhdMV","timestamp":1648952096840}]},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.8.8"}},"nbformat":4,"nbformat_minor":0}